diff -Naur llvm-project/clang/utils/creduce-clang-crash.py llvm-project/clang/utils/creduce-clang-crash.py
--- llvm-project/clang/utils/creduce-clang-crash.py	2024-06-22 14:58:04.110536250 +0000
+++ llvm-project/clang/utils/creduce-clang-crash.py	2024-06-22 15:00:07.092158770 +0000
@@ -14,7 +14,6 @@
 import stat
 import sys
 import subprocess
-import pipes
 import shlex
 import tempfile
 import shutil
@@ -57,7 +56,7 @@
   sys.exit("ERROR: `%s` not found in %s" % (cmd_name, cmd_dir))
 
 def quote_cmd(cmd):
-  return ' '.join(pipes.quote(arg) for arg in cmd)
+  return ' '.join(shlex.quote(arg) for arg in cmd)
 
 def write_to_script(text, filename):
   with open(filename, 'w') as f:
@@ -199,7 +198,7 @@
 """ % (disable_symbolization, quote_cmd(self.get_crash_cmd()))
 
     for msg in self.expected_output:
-      output += 'grep -F %s t.log || exit 1\n' % pipes.quote(msg)
+      output += 'grep -F %s t.log || exit 1\n' % shlex.quote(msg)
 
     write_to_script(output, self.testfile)
     self.check_interestingness()
diff -Naur llvm-project/compiler-rt/test/asan/lit.cfg.py llvm-project/compiler-rt/test/asan/lit.cfg.py
--- llvm-project/compiler-rt/test/asan/lit.cfg.py	2024-06-22 14:57:36.667612165 +0000
+++ llvm-project/compiler-rt/test/asan/lit.cfg.py	2024-06-22 15:00:52.711357235 +0000
@@ -6,14 +6,8 @@
 
 import lit.formats
 
-# Get shlex.quote if available (added in 3.3), and fall back to pipes.quote if
-# it's not available.
-try:
-  import shlex
-  sh_quote = shlex.quote
-except:
-  import pipes
-  sh_quote = pipes.quote
+import shlex
+sh_quote = shlex.quote
 
 def get_required_attr(config, attr_name):
   attr_value = getattr(config, attr_name, None)
diff -Naur llvm-project/compiler-rt/test/lit.common.cfg.py llvm-project/compiler-rt/test/lit.common.cfg.py
--- llvm-project/compiler-rt/test/lit.common.cfg.py	2024-06-22 14:57:34.532462464 +0000
+++ llvm-project/compiler-rt/test/lit.common.cfg.py	2024-06-22 15:01:12.357734687 +0000
@@ -12,14 +12,8 @@
 import lit.formats
 import lit.util
 
-# Get shlex.quote if available (added in 3.3), and fall back to pipes.quote if
-# it's not available.
-try:
-  import shlex
-  sh_quote = shlex.quote
-except:
-  import pipes
-  sh_quote = pipes.quote
+import shlex
+sh_quote = shlex.quote
 
 def find_compiler_libdir():
   """
diff -Naur llvm-project/compiler-rt/test/memprof/lit.cfg.py llvm-project/compiler-rt/test/memprof/lit.cfg.py
--- llvm-project/compiler-rt/test/memprof/lit.cfg.py	2024-06-22 14:57:36.734616862 +0000
+++ llvm-project/compiler-rt/test/memprof/lit.cfg.py	2024-06-22 15:01:32.172123921 +0000
@@ -6,14 +6,8 @@
 
 import lit.formats
 
-# Get shlex.quote if available (added in 3.3), and fall back to pipes.quote if
-# it's not available.
-try:
-  import shlex
-  sh_quote = shlex.quote
-except:
-  import pipes
-  sh_quote = pipes.quote
+import shlex
+sh_quote = shlex.quote
 
 def get_required_attr(config, attr_name):
   attr_value = getattr(config, attr_name, None)
diff -Naur llvm-project/libcxx/utils/libcxx/test/dsl.py llvm-project/libcxx/utils/libcxx/test/dsl.py
--- llvm-project/libcxx/utils/libcxx/test/dsl.py	2024-06-22 14:57:57.291058121 +0000
+++ llvm-project/libcxx/utils/libcxx/test/dsl.py	2024-06-22 15:01:55.698773427 +0000
@@ -8,7 +8,7 @@
 
 import os
 import pickle
-import pipes
+import shlex
 import platform
 import re
 import shutil
@@ -261,7 +261,7 @@
       }
     #endif
   """
-  return programSucceeds(config, program, args=[pipes.quote(l) for l in locales])
+  return programSucceeds(config, program, args=[shlex.quote(l) for l in locales])
 
 @_memoizeExpensiveOperation(lambda c, flags='': (c.substitutions, c.environment, flags))
 def compilerMacros(config, flags=''):
diff -Naur llvm-project/libcxx/utils/libcxx/test/format.py llvm-project/libcxx/utils/libcxx/test/format.py
--- llvm-project/libcxx/utils/libcxx/test/format.py	2024-06-22 14:57:57.292058191 +0000
+++ llvm-project/libcxx/utils/libcxx/test/format.py	2024-06-22 15:02:11.564885834 +0000
@@ -9,7 +9,7 @@
 import lit
 import lit.formats
 import os
-import pipes
+import shlex
 import re
 import shutil
 
diff -Naur ninja/configure.py ninja/configure.py
--- ninja/configure.py	2024-06-22 14:57:34.179437713 +0000
+++ ninja/configure.py	2024-06-22 14:59:43.507505194 +0000
@@ -23,7 +23,7 @@
 
 from optparse import OptionParser
 import os
-import pipes
+import shlex
 import string
 import subprocess
 import sys
@@ -264,7 +264,7 @@
 env_keys = set(['CXX', 'AR', 'CFLAGS', 'CXXFLAGS', 'LDFLAGS'])
 configure_env = dict((k, os.environ[k]) for k in os.environ if k in env_keys)
 if configure_env:
-    config_str = ' '.join([k + '=' + pipes.quote(configure_env[k])
+    config_str = ' '.join([k + '=' + shlex.quote(configure_env[k])
                            for k in configure_env])
     n.variable('configure_env', config_str + '$ ')
 n.newline()
